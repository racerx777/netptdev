<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>Blueshoes SpreadSheet</title>
  <style>
    td {
    	font-family : Arial, Helvetica, sans-serif;
    	font-size : 13px;
    }
  </style>
<script language="JavaScript" type="text/javascript" src="/_bsJavascript/core/html/Bs_HtmlUtil.lib.js"></script>
<script language="JavaScript" type="text/javascript" src="/_bsJavascript/core/lang/Bs_Array.class.js"></script>
<script language="JavaScript" type="text/javascript" src="/_bsJavascript/components/spreadsheet/Bs_SpreadSheet.class.js"></script>
<script language="JavaScript" type="text/javascript" src="/_libDomapi/core_c.js"></script>
<script language="JavaScript" type="text/javascript" src="/_libDomapi/gui/menu_c.js"></script>
<script language="JavaScript" type="text/javascript" src="/_bsJavascript/components/spreadsheet/Bs_SpreadSheet.inc.js"></script>
<script language="JavaScript" src="/_bsJavascript/components/toolbar/Bs_ButtonBar.class.js" type="text/javascript"></script>
<script language="JavaScript" src="/_bsJavascript/components/toolbar/Bs_Button.class.js" type="text/javascript"></script>

<script>
function bs_isGecko() {
  //rather poor implementation.
  if (navigator.appName == "Microsoft Internet Explorer") return false;
  return (navigator.userAgent.match(/gecko/i));
}
if (bs_isGecko()) {
  document.writeln("<link rel='stylesheet' href='/_bsJavascript/components/toolbar/win2k_mz.css'>");
} else {
  document.writeln("<link rel='stylesheet' href='/_bsJavascript/components/toolbar/win2k_ie.css'>");
}
</script>

<script>
function bs_ss_pageLoaded() {
  mySpreadSheet = new Bs_SpreadSheet;
  mySpreadSheet.objectName = 'mySpreadSheet';
  mySpreadSheet.mayUseFormat  = false;
  mySpreadSheet.mayUseAlign   = false;
  mySpreadSheet.mayUseWysiwyg = false;
  mySpreadSheet.returnType    = "csv";
	//bs_ss_init(); //call parent window, we are ready.
	bs_ss_initData(parent.dataCsv);
}
function bs_ss_initData(data) {
  mySpreadSheet.init(data, 'dataTableDiv', bs_ss_callbackOnSave);
}
function bs_ss_callbackOnSave() {
  alert('save');
}
</script>
</head>

<body id="body" onLoad="onLoadFunction();">

<form name="spreadsheet">
<div id="dataTableDiv" style="width:450; height:300; overflow:hidden;"></div>
</form>

</body>
</html>
